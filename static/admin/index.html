<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Content Manager</title>
  <script>
    window.CMS_MANUAL_INIT = true;
    
    // 直接在HTML中定义配置
    window.DECAP_CMS_CONFIG = {
      backend: {
        name: "github",
        repo: "x1aohe1/x1aohe1.github.io",
        branch: "main",
        auth_type: "web",
        client_id: "Ov23liUDGabIOat1t2KY",
        scope: "repo,user:email"
      },
      site_url: "https://x1aohe1.github.io",
      display_url: "https://x1aohe1.github.io",
      media_folder: "static/images",
      public_folder: "/images",
      collections: [
        {
          name: "posts",
          label: "Posts",
          folder: "content/posts",
          create: true,
          slug: "{{slug}}",
          fields: [
            { label: "Title", name: "title", widget: "string" },
            { label: "Body", name: "body", widget: "markdown" }
          ]
        }
      ]
    };
  </script>
</head>
<body>
  <div id="nc-root">
    <noscript>You need to enable JavaScript to run this app.</noscript>
  </div>

  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
  
  <script>
    window.addEventListener('load', function() {
      console.log('Page fully loaded');
      console.log('Config available:', window.DECAP_CMS_CONFIG);
      
      setTimeout(function() {
        if (window.CMS) {
          console.log('Initializing CMS with inline config...');
          try {
            // 使用内联配置初始化
            CMS.init({ config: window.DECAP_CMS_CONFIG });
            console.log('CMS initialized successfully');
            
            setTimeout(() => {
              console.log('Backend after init:', CMS.getBackend());
            }, 1000);
            
          } catch (error) {
            console.error('CMS initialization failed:', error);
          }
        }
      }, 500);
    });
  </script>
</body>
</html>